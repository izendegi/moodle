{"version":3,"file":"mediatype.min.js","sources":["../src/mediatype.js"],"sourcesContent":["// This file is part of Moodle - https://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <https://www.gnu.org/licenses/>.\n\n/**\n * Media selection widget handler.\n *\n * NOTE: this was abstracted form board.js\n *\n * @copyright  2021 Brickfield Education Labs <https://www.brickfield.ie/>\n * @license    https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from \"jquery\";\n\n/**\n * Indicates if this is a keycode we want to listend to for\n * aria purposes.\n *\n * @returns {boolean}\n * @param {number} key\n */\nconst isAriaTriggerKey = function(key) {\n    return key == 13 || key == 32;\n};\n\n/**\n * Handler for keypress and click actions.\n *\n * @param {object} elem\n * @param {function} callback\n * @returns {*}\n */\nconst handleAction = function(elem, callback) {\n    return elem.on('click keypress', function(e) {\n        if (e.type === 'keypress') {\n            if (isAriaTriggerKey(e.keyCode)) {\n                e.preventDefault();\n            } else {\n                return;\n            }\n        }\n\n        callback();\n        e.preventDefault();\n    });\n};\n\n/**\n * Entrypoint of the js.\n *\n * @method init\n * @param {String} formId Id attribute of note editing form.\n */\nexport const init = (formId) => {\n    const form = $(document.getElementById(formId));\n    const mediaElement = form.find('.mod_board_type');\n    const mediaSelect = $(mediaElement).find('select');\n\n    // First hide the select menu.\n    mediaElement.hide();\n\n    const changeEvent = document.createEvent('HTMLEvents');\n    changeEvent.initEvent('change', true, true);\n\n    let ytButton = form.find('.mod_board_attachment_button.youtube_button'),\n        pictureButton = form.find('.mod_board_attachment_button.image_button'),\n        linkButton = form.find('.mod_board_attachment_button.link_button'),\n        fileButton = form.find('.mod_board_attachment_button.file_button'),\n        updateMediaButtons = function() {\n            ytButton.removeClass('selected');\n            pictureButton.removeClass('selected');\n            linkButton.removeClass('selected');\n            fileButton.removeClass('selected');\n            switch (mediaSelect.val()) {\n                case (\"1\"):\n                    ytButton.addClass('selected');\n                    break;\n                case (\"2\"):\n                    pictureButton.addClass('selected');\n                    break;\n                case (\"3\"):\n                    linkButton.addClass('selected');\n                    break;\n                case (\"4\"):\n                    fileButton.addClass('selected');\n                    break;\n            }\n        };\n\n    updateMediaButtons();\n    handleAction(ytButton, function() {\n        if (mediaSelect.val() === \"1\") {\n            mediaSelect.val(0);\n        } else {\n            mediaSelect.val(1);\n        }\n        updateMediaButtons();\n        mediaSelect[0].dispatchEvent(changeEvent);\n    });\n    handleAction(pictureButton, function() {\n        if (mediaSelect.val() === \"2\") {\n            mediaSelect.val(0);\n        } else {\n            mediaSelect.val(2);\n        }\n        updateMediaButtons();\n        mediaSelect[0].dispatchEvent(changeEvent);\n    });\n    handleAction(linkButton, function() {\n        if (mediaSelect.val() === \"3\") {\n            mediaSelect.val(0);\n        } else {\n            mediaSelect.val(3);\n        }\n        updateMediaButtons();\n        mediaSelect[0].dispatchEvent(changeEvent);\n    });\n    handleAction(fileButton, function() {\n        if (mediaSelect.val() === \"4\") {\n            mediaSelect.val(0);\n        } else {\n            mediaSelect.val(4);\n        }\n        updateMediaButtons();\n        mediaSelect[0].dispatchEvent(changeEvent);\n    });\n};\n"],"names":["handleAction","elem","callback","on","e","type","key","keyCode","preventDefault","formId","form","document","getElementById","mediaElement","find","mediaSelect","hide","changeEvent","createEvent","initEvent","ytButton","pictureButton","linkButton","fileButton","updateMediaButtons","removeClass","val","addClass","dispatchEvent"],"mappings":";;;;;;;;gJA4CMA,aAAe,SAASC,KAAMC,iBACzBD,KAAKE,GAAG,kBAAkB,SAASC,MACvB,aAAXA,EAAEC,KAAqB,IAZjB,KADgBC,IAcDF,EAAEG,UAbJ,IAAPD,WAcRF,EAAEI,iBAfO,IAASF,IAqB1BJ,WACAE,EAAEI,mCAUWC,eACXC,MAAO,mBAAEC,SAASC,eAAeH,SACjCI,aAAeH,KAAKI,KAAK,mBACzBC,aAAc,mBAAEF,cAAcC,KAAK,UAGzCD,aAAaG,aAEPC,YAAcN,SAASO,YAAY,cACzCD,YAAYE,UAAU,UAAU,GAAM,OAElCC,SAAWV,KAAKI,KAAK,+CACrBO,cAAgBX,KAAKI,KAAK,6CAC1BQ,WAAaZ,KAAKI,KAAK,4CACvBS,WAAab,KAAKI,KAAK,4CACvBU,mBAAqB,kBACjBJ,SAASK,YAAY,YACrBJ,cAAcI,YAAY,YAC1BH,WAAWG,YAAY,YACvBF,WAAWE,YAAY,YACfV,YAAYW,WACV,IACFN,SAASO,SAAS,sBAEhB,IACFN,cAAcM,SAAS,sBAErB,IACFL,WAAWK,SAAS,sBAElB,IACFJ,WAAWI,SAAS,cAKpCH,qBACAxB,aAAaoB,UAAU,WACO,MAAtBL,YAAYW,MACZX,YAAYW,IAAI,GAEhBX,YAAYW,IAAI,GAEpBF,qBACAT,YAAY,GAAGa,cAAcX,gBAEjCjB,aAAaqB,eAAe,WACE,MAAtBN,YAAYW,MACZX,YAAYW,IAAI,GAEhBX,YAAYW,IAAI,GAEpBF,qBACAT,YAAY,GAAGa,cAAcX,gBAEjCjB,aAAasB,YAAY,WACK,MAAtBP,YAAYW,MACZX,YAAYW,IAAI,GAEhBX,YAAYW,IAAI,GAEpBF,qBACAT,YAAY,GAAGa,cAAcX,gBAEjCjB,aAAauB,YAAY,WACK,MAAtBR,YAAYW,MACZX,YAAYW,IAAI,GAEhBX,YAAYW,IAAI,GAEpBF,qBACAT,YAAY,GAAGa,cAAcX"}