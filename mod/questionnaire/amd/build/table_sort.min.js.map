{"version":3,"file":"table_sort.min.js","sources":["../src/table_sort.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JavaScript library for questionnaire response table sorting.\n *\n * @module     mod_questionnaire/table_sort\n * @copyright\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery'], function($) {\n\n    var t = {\n        /**\n         * Initialise the event listeners.\n         *\n         */\n        init: function() {\n            M.util.js_pending('mod_questionnaire_tablesort');\n            $(\".qn-handcursor\").on('click', t.sortcolumn);\n            M.util.js_complete('mod_questionnaire_tablesort');\n        },\n\n        /**\n         * Javascript for sorting s'Text Box' Response.\n         * @param {Event} e\n         */\n        sortcolumn: function(e) {\n            e.preventDefault();\n            var col = $(this).index();\n            var id = $(this).closest('table').attr('id');\n            var sortOrder = 1;\n            $(this).siblings().find('span[class^=\"icon-container-\"]').hide();\n            $(this).siblings().removeClass('asc desc');\n            $(this).find('span[class^=\"icon-container-\"]').removeAttr('style');\n            if ($(this).is('.asc')) {\n                $(this).removeClass('asc').addClass('desc');\n                sortOrder = -1;\n            } else {\n                $(this).addClass('asc').removeClass('desc');\n            }\n            var arrData = $(this).closest('table').find('tbody >tr:has(td.cell)').get();\n            arrData.sort(function (a, b) {\n                var val1 = $(a).children('td').eq(col).text();\n                var val2 = $(b).children('td').eq(col).text();\n                // Regex to check for date sorting.\n                var dateregx = /^\\d{2}.*\\d{4},/;\n                if (dateregx.test(val1) && dateregx.test(val2)) {\n                    val1 = new Date(val1);\n                    val2 = new Date(val2);\n                    return (val1 < val2) ? -sortOrder : (val1 > val2) ? sortOrder : 0;\n                } else if ($.isNumeric(val1) && $.isNumeric(val2)) {\n                    return sortOrder == 1 ? val1 - val2 : val2 - val1;\n                } else {\n                    return (val1 < val2) ? -sortOrder : (val1 > val2) ? sortOrder : 0;\n                }\n            });\n            /* Append the sorted rows to tbody*/\n            $.each(arrData, function (index, row) {\n                var tableid = $('#' + id + ' tbody');\n                tableid.append(row);\n            });\n        },\n    };\n    return t;\n});"],"names":["define","$","t","init","M","util","js_pending","on","sortcolumn","js_complete","e","preventDefault","col","this","index","id","closest","attr","sortOrder","siblings","find","hide","removeClass","removeAttr","is","addClass","arrData","get","sort","a","b","val1","children","eq","text","val2","dateregx","test","Date","isNumeric","each","row","append"],"mappings":";;;;;;;AAsBAA,sCAAO,CAAC,WAAW,SAASC,OAEpBC,EAAI,CAKJC,KAAM,WACFC,EAAEC,KAAKC,WAAW,+BAClBL,EAAE,kBAAkBM,GAAG,QAASL,EAAEM,YAClCJ,EAAEC,KAAKI,YAAY,gCAOvBD,WAAY,SAASE,GACjBA,EAAEC,qBACEC,IAAMX,EAAEY,MAAMC,QACdC,GAAKd,EAAEY,MAAMG,QAAQ,SAASC,KAAK,MACnCC,UAAY,EAChBjB,EAAEY,MAAMM,WAAWC,KAAK,kCAAkCC,OAC1DpB,EAAEY,MAAMM,WAAWG,YAAY,YAC/BrB,EAAEY,MAAMO,KAAK,kCAAkCG,WAAW,SACtDtB,EAAEY,MAAMW,GAAG,SACXvB,EAAEY,MAAMS,YAAY,OAAOG,SAAS,QACpCP,WAAa,GAEbjB,EAAEY,MAAMY,SAAS,OAAOH,YAAY,YAEpCI,QAAUzB,EAAEY,MAAMG,QAAQ,SAASI,KAAK,0BAA0BO,MACtED,QAAQE,MAAK,SAAUC,EAAGC,OAClBC,KAAO9B,EAAE4B,GAAGG,SAAS,MAAMC,GAAGrB,KAAKsB,OACnCC,KAAOlC,EAAE6B,GAAGE,SAAS,MAAMC,GAAGrB,KAAKsB,OAEnCE,SAAW,wBACXA,SAASC,KAAKN,OAASK,SAASC,KAAKF,OACrCJ,KAAO,IAAIO,KAAKP,QAChBI,KAAO,IAAIG,KAAKH,QACQjB,UAAaa,KAAOI,KAAQjB,UAAY,EACzDjB,EAAEsC,UAAUR,OAAS9B,EAAEsC,UAAUJ,MACpB,GAAbjB,UAAiBa,KAAOI,KAAOA,KAAOJ,KAErCA,KAAOI,MAASjB,UAAaa,KAAOI,KAAQjB,UAAY,KAIxEjB,EAAEuC,KAAKd,SAAS,SAAUZ,MAAO2B,KACfxC,EAAE,IAAMc,GAAK,UACnB2B,OAAOD,iBAIpBvC"}