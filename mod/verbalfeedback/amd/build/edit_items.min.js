/**
 * AMD code for the frequently used comments chooser for the marking guide grading form.
 *
 * @module     mod_verbalfeedback/edit_items
 * @class      edit_items
 * @copyright  2020 Kevin Tippenhauer <kevin.tippenhauer@bfh.ch>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_verbalfeedback/edit_items",["jquery","core/templates","core/notification","core/ajax","core/str","core/yui"],(function($,Templates,Notification,Ajax){let ACTIONS_CATEGORY_PERCENTAGE_CHANGED='[data-action="change-category-percentage"]',ACTIONS_ITEM_MULTIPLIER_CHANGED='[data-action="change-item-multiplier"]',editItems=function(){this.registerEvents()},updateSum=function(){let sum=0;$(".category-percentage").each((function(){sum+=parseFloat($(this).val())})),1!=sum?($(".category-percentage").addClass("is-invalid"),$("#percentage-total").addClass("text-danger"),$("#percentage-total-value").text(parseFloat(100*sum).toFixed(2))):($(".category-percentage").removeClass("is-invalid"),$("#percentage-total").removeClass("text-danger"),$("#percentage-total-value").text(parseFloat(100*sum).toFixed(2)))};return editItems.callCategoryAction=function(action,elem){updateSum(),Ajax.call([{methodname:action,args:{categoryid:elem.data("categoryid"),percentage:elem.val()}}])[0].done((function(response){if(!response.success){let warnings=response.warnings.join($("<br/>"));throw new Error(warnings)}elem.next().stop(!0,!0).show().fadeOut(1e3)})).fail(Notification.exception)},editItems.callItemAction=function(action,elem){Ajax.call([{methodname:action,args:{itemid:elem.data("itemid"),multiplier:elem.val()}}])[0].done((function(response){if(!response.success){let warnings=response.warnings.join($("<br />"));throw new Error(warnings)}elem.next().stop(!0,!0).show().fadeOut(1e3)})).fail(Notification.exception)},editItems.prototype.registerEvents=function(){$(ACTIONS_CATEGORY_PERCENTAGE_CHANGED).change((function(e){e.preventDefault(),editItems.callCategoryAction("mod_verbalfeedback_update_category_percentage",$(this))})),$(ACTIONS_ITEM_MULTIPLIER_CHANGED).change((function(e){e.preventDefault(),this.value>5&&(this.value=5),this.value=parseFloat(this.value).toFixed(2),editItems.callItemAction("mod_verbalfeedback_update_item_multiplier",$(this))}))},editItems.prototype.updatePercentageSum=updateSum,editItems}));

//# sourceMappingURL=edit_items.min.js.map